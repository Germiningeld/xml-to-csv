# Настройка конфигурации

Этот документ описывает параметры конфигурационного файла для Универсального парсера XML.

## Формат конфигурации

Конфигурация задается в формате JSON, что позволяет легко редактировать настройки без изменения исходного кода. Ниже приведен пример полного конфигурационного файла со всеми доступными параметрами:

```json
{
  "input_file": "catalog.xml",
  "output_dir": "output/exports",
  
  "format": "xlsx",
  
  "encoding": "cp1251",
  "csv_delimiter": ";",
  
  "delimiter": "||",
  "max_field_length": 32767,
  
  "main_element_path": "shop/offers/offer",
  
  "include_paths": [
    "shop/offers/offer[@id]",
    "shop/offers/offer[@available]",
    "shop/offers/offer/name",
    "shop/offers/offer/vendorCode"
  ],
  
  "exclude_paths": [
    "shop/offers/offer/delivery",
    "shop/offers/offer/pickup"
  ],
  
  "max_depth": 15,
  
  "log_level": "INFO",
  
  "clean_html": true,
  "preserve_linebreaks": false,
  
  "replace_invisible_chars": true,
  "normalize_whitespace": true
}
```

## Описание параметров

### Основные параметры

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `input_file` | строка | - | Путь к входному XML файлу |
| `output_dir` | строка | `"output"` | Директория для сохранения результатов |

### Параметры вывода

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `format` | строка | `"xlsx"` | Формат выходного файла: `"xlsx"` или `"csv"` |
| `encoding` | строка | `"utf-8"` | Кодировка для CSV файла |
| `csv_delimiter` | строка | `";"` | Разделитель для CSV файла |

### Параметры обработки данных

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `delimiter` | строка | `"||"` | Разделитель для списков в выходном файле |
| `max_field_length` | число | `32767` | Максимальная длина поля (для Excel) |
| `main_element_path` | строка | - | Основной элемент для обработки (если не указан, определяется автоматически) |
| `max_depth` | число | `10` | Максимальная глубина рекурсии при анализе XML |

### Фильтрация данных

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `include_paths` | массив строк | `[]` | Пути XPath для включения в результат (если указаны, используются только они) |
| `exclude_paths` | массив строк | `[]` | Пути XPath для исключения из результата |

### Параметры очистки текста

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `clean_html` | булево | `true` | Удалять HTML-теги из текста |
| `preserve_linebreaks` | булево | `false` | Сохранять переносы строк |
| `replace_invisible_chars` | булево | `true` | Заменять невидимые символы |
| `normalize_whitespace` | булево | `true` | Нормализовать пробелы (удалять лишние) |

### Параметры логирования

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `log_level` | строка | `"INFO"` | Уровень логирования (`DEBUG`, `INFO`, `WARNING`, `ERROR`) |

## Пример использования

Создайте файл `config.json` в корневой директории проекта и укажите необходимые параметры:

```json
{
  "input_file": "data/feed.xml",
  "output_dir": "results",
  "format": "csv",
  "encoding": "utf-8",
  "main_element_path": "catalog/product",
  "include_paths": [
    "catalog/product[@id]",
    "catalog/product/name",
    "catalog/product/price",
    "catalog/product/description"
  ]
}
```

Затем запустите скрипт с указанием пути к файлу конфигурации:

```bash
python xmlparser.py --config config.json
```

## Приоритет параметров

Параметры применяются в следующем порядке приоритета (от высшего к низшему):

1. Аргументы командной строки
2. Параметры, переданные программно
3. Конфигурационный файл
4. Значения по умолчанию

Это позволяет гибко настраивать поведение программы в зависимости от конкретной задачи.